<!DOCTYPE html>
<htmlidioma="es">
<cabeza>
  <metaconjunto de caracteres="UTF-8">
  <metanombre="ventana gráfica"contenido="ancho=ancho del dispositivo, escala inicial=1.0">
  <título>Gestión de usuarios</título>
  <enlacehref="https://cdn.jsdelivr.net/npm/tailwindcss/dist/tailwind.min.css"rel="hoja de estilo">
  <guiónorigen="https://code.jquery.com/jquery-3.6.0.min.js"></script>
Asegúrese de que no utilizar la función de integridad de recursos sea seguro aquí.

  <!-- Axios -->
  <guiónorigen="https://unpkg.com/axios/dist/axios.min.js"></script>
</cabeza>
<cuerpoclase="bg-gray-100">
  <!-- El menú lateral se insertará automáticamente -->
  <guiónorigen="js/sidebar.js"></script>
  <divisiónclase=Contenedor MX-Auto P-4>
    <h1clase="texto-2xl mb-4">Gestión de usuarios</h1>
    <formidentificación="Formulario de usuario"clase=MB-4 blanco y negro, P-4, sombra redondeada>
      <entradatipo="oculto"identificación="ID de usuario">
      <divisiónclase="mb-2">
        <etiquetapara="nombre"clase="bloquear">Nombres</etiqueta>
        <entradatipo="texto"identificación="nombre"clase="borde p-2 w-completo">
      </div>
      <divisiónclase="mb-2">
        <etiquetapara="correo electrónico"clase="bloquear">Correo</etiqueta>
        <entradatipo="texto"identificación="correo electrónico"clase="borde p-2 w-completo">
      </div>
      <divisiónclase="mb-2">
        <etiquetapara="contraseña"clase="bloquear">Contraseña</etiqueta>
        <entradatipo="contraseña"identificación="contraseña"clase="borde p-2 w-completo">
      </div>
      <divisiónclase="mb-2">
        <etiquetapara="role"clase="bloquear">Rol</etiqueta>
        <seleccionaridentificación="role"clase="borde p-2 w-completo">
          <opciónvalor="usuario">Usuario</opción>
          <opciónvalor="administración">Administrador</opción>
        </seleccionar>
      </div>
      <botóntipo="entregar"clase="bg-azul-500 texto-blanco px-4 py-2 redondeado">Guardar</botón>
      <botóntipo="botón"identificación="Cancelar"clase="bg-gray-500 texto-blanco px-4 py-2 redondeado ml-2">Cancelar</botón>
    </form>
    <tablaclase="sombra blanca mínima-ancha-completa redondeada">
      <cabeza>
        <tr>
          <oclase="px-4 py-2">Nombres</th>
          <oclase="px-4 py-2">Usuario</th>
          <oclase="px-4 py-2">Rol</th>
          <oclase="px-4 py-2">Acciones</th>
        </tr>
      </cabeza>
      <cuerpoidentificación="Tabla de usuarios"clase="divide-y divide-gray-200"></tbody>
    </tabla>
  </div>
  <guión>
    const apiUrl = '/api/usuarios';
    función fetchUsers() {
      $.get(apiUrl, datos =>{
        const filas = datos.map(u =>`
          <tr>
            <tdclase="px-4 py-2">${u.nombre}</td>
            <tdclase="px-4 py-2">${u.email}</td>
            <tdclase="px-4 py-2">${u.role}</td>
            <tdclase="px-4 py-2 espacio-x-2">
              <botónclase=Editar fondo amarillo 400 px-2 redondeadoid de datos="${u.id}">Editar</botón>
              <botónclase=Eliminar fondo rojo 500, texto blanco, px 2 redondeadoid de datos="${u.id}">Eliminar</botón>
            </td>
          </tr>
        `);
        $('#usersTable').html(filas.join(''));
      });
    }
    función resetForm() {
      $('#userId').val('');
      $('#nombre').val('');
      $('#correo electrónico').val('');
      $('#contraseña').val('');
      $('#role').val('usuario');
    }
    $(documento).ready(función() {
      buscarUsuarios();
      $('#userForm').submit(función(e) {
        e.preventDefault();
        constante id = $('#userId').val();
        constante userData = {
          nombre: $('#nombre').val(),
          correo electrónico: $('#email').val(),
          contraseña: $('#password').val(),
          rol: $('#role').val()
        };
        si (id) {
          $.ajax({
            URL: `${apiUrl}/${id}`,
            método: 'PUT',
            tipo de contenido: 'application/json',
            datos: JSON.stringify(userData),
            éxito: función() {
              obtenerUsuarios(); restablecerFormulario();
            }
          });
        } demás {
          $.ajax({
            URL: apiUrl,
            método: 'POST',
            tipo de contenido: 'application/json',
            datos: JSON.stringify(userData),
            éxito: función() {
              obtenerUsuarios(); restablecerFormulario();
            }
          });
        }
      });
      $('#cancel').click(resetForm);
      $('#usersTable').on('click', '.edit', function() {
        constante id = $(this).data('id');
        $.get(`${apiUrl}/${id}`, función(u) {
          $('#userId').val(u.id);
          $('#nombre').val(u.nombre);
          $('#email').val(u.email);
          $('#role').val(u.role);
        });
      });
      $('#usersTable').on('click', '.delete', function() {
        constante id = $(this).data('id');
        if (confirm('¿Quieres eliminar este usuario?')) {
          $.ajax({
            URL: `${apiUrl}/${id}`,
            método: 'BORRAR',
            éxito: función() {
              buscarUsuarios();
            }
          });
        }
      });
    });
  </script>
</cuerpo>
</html>